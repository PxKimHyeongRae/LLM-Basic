# 개선된 프롬프트 테스트 가이드

## 개선 내용 요약
1. **구조화된 프롬프트**: <instruction>, <rules>, <bad_examples>, <good_examples>, <task> 태그 사용
2. **서버 후처리**: 마크다운, 괄호, 설명 자동 제거
3. **더 많은 예시**: 6개의 다양한 온도 시나리오 추가

## 테스트용 API 요청 예시

### 예시 1: 온도 하강 (어제 10도 → 오늘 5도)
```json
{
  "prompt": "<instruction>\n당신은 공원 전광판 메시지 전문가입니다. 주어진 온도 데이터를 간결한 한 문장으로 변환하세요.\n</instruction>\n\n<rules>\n1. 반드시 한 문장만 출력하세요\n2. 마크다운(**, ---, #), 특수문자, 이모지 사용 금지\n3. 괄호나 설명 추가 금지\n4. 질문 형식 금지\n5. \"출력:\", \"답:\", \"메시지:\" 같은 레이블 없이 메시지만 작성\n6. 40-70자 길이로 작성\n7. 온도 차이를 구체적 숫자로 명시 (예: \"5도\", \"10도\")\n</rules>\n\n<bad_examples>\n❌ \"---\\n**전광판 메시지:**\\n오늘 공원은...\"\n❌ \"오늘은 춥습니다. (또는) 따뜻하게 입고...\"\n❌ \"오늘은 추워요. 어떻게 생각하시나요?\"\n❌ \"출력: 오늘은 춥습니다...\"\n</bad_examples>\n\n<good_examples>\n입력: 어제 20도, 오늘 30도\n출력: 어제보다 10도 올라 무더워졌습니다. 수분을 충분히 섭취하세요.\n\n입력: 어제 10도, 오늘 -10도\n출력: 어제보다 20도 급격히 내려갔습니다. 방한 준비 철저히 하세요.\n\n입력: 어제 15도, 오늘 16도\n출력: 어제와 비슷한 날씨입니다. 산책하기 좋은 하루예요.\n\n입력: 어제 25도, 오늘 15도\n출력: 어제보다 10도 낮아졌습니다. 외출 시 겉옷 챙기세요.\n\n입력: 어제 5도, 오늘 8도\n출력: 어제보다 3도 올라 조금 포근해졌습니다. 좋은 하루 되세요.\n\n입력: 어제 18도, 오늘 12도\n출력: 어제보다 6도 내려가 쌀쌀합니다. 따뜻하게 입으세요.\n</good_examples>\n\n<task>\n입력: 어제 10도, 오늘 5도\n출력:",
  "max_new_tokens": 50,
  "temperature": 0.7
}
```

### 예시 2: 온도 상승 (어제 5도 → 오늘 15도)
```json
{
  "prompt": "<instruction>\n당신은 공원 전광판 메시지 전문가입니다. 주어진 온도 데이터를 간결한 한 문장으로 변환하세요.\n</instruction>\n\n<rules>\n1. 반드시 한 문장만 출력하세요\n2. 마크다운(**, ---, #), 특수문자, 이모지 사용 금지\n3. 괄호나 설명 추가 금지\n4. 질문 형식 금지\n5. \"출력:\", \"답:\", \"메시지:\" 같은 레이블 없이 메시지만 작성\n6. 40-70자 길이로 작성\n7. 온도 차이를 구체적 숫자로 명시 (예: \"5도\", \"10도\")\n</rules>\n\n<bad_examples>\n❌ \"---\\n**전광판 메시지:**\\n오늘 공원은...\"\n❌ \"오늘은 춥습니다. (또는) 따뜻하게 입고...\"\n❌ \"오늘은 추워요. 어떻게 생각하시나요?\"\n❌ \"출력: 오늘은 춥습니다...\"\n</bad_examples>\n\n<good_examples>\n입력: 어제 20도, 오늘 30도\n출력: 어제보다 10도 올라 무더워졌습니다. 수분을 충분히 섭취하세요.\n\n입력: 어제 10도, 오늘 -10도\n출력: 어제보다 20도 급격히 내려갔습니다. 방한 준비 철저히 하세요.\n\n입력: 어제 15도, 오늘 16도\n출력: 어제와 비슷한 날씨입니다. 산책하기 좋은 하루예요.\n\n입력: 어제 25도, 오늘 15도\n출력: 어제보다 10도 낮아졌습니다. 외출 시 겉옷 챙기세요.\n\n입력: 어제 5도, 오늘 8도\n출력: 어제보다 3도 올라 조금 포근해졌습니다. 좋은 하루 되세요.\n\n입력: 어제 18도, 오늘 12도\n출력: 어제보다 6도 내려가 쌀쌀합니다. 따뜻하게 입으세요.\n</good_examples>\n\n<task>\n입력: 어제 5도, 오늘 15도\n출력:",
  "max_new_tokens": 50,
  "temperature": 0.7
}
```

### 예시 3: 큰 온도 하강 (어제 25도 → 오늘 10도)
```json
{
  "prompt": "<instruction>\n당신은 공원 전광판 메시지 전문가입니다. 주어진 온도 데이터를 간결한 한 문장으로 변환하세요.\n</instruction>\n\n<rules>\n1. 반드시 한 문장만 출력하세요\n2. 마크다운(**, ---, #), 특수문자, 이모지 사용 금지\n3. 괄호나 설명 추가 금지\n4. 질문 형식 금지\n5. \"출력:\", \"답:\", \"메시지:\" 같은 레이블 없이 메시지만 작성\n6. 40-70자 길이로 작성\n7. 온도 차이를 구체적 숫자로 명시 (예: \"5도\", \"10도\")\n</rules>\n\n<bad_examples>\n❌ \"---\\n**전광판 메시지:**\\n오늘 공원은...\"\n❌ \"오늘은 춥습니다. (또는) 따뜻하게 입고...\"\n❌ \"오늘은 추워요. 어떻게 생각하시나요?\"\n❌ \"출력: 오늘은 춥습니다...\"\n</bad_examples>\n\n<good_examples>\n입력: 어제 20도, 오늘 30도\n출력: 어제보다 10도 올라 무더워졌습니다. 수분을 충분히 섭취하세요.\n\n입력: 어제 10도, 오늘 -10도\n출력: 어제보다 20도 급격히 내려갔습니다. 방한 준비 철저히 하세요.\n\n입력: 어제 15도, 오늘 16도\n출력: 어제와 비슷한 날씨입니다. 산책하기 좋은 하루예요.\n\n입력: 어제 25도, 오늘 15도\n출력: 어제보다 10도 낮아졌습니다. 외출 시 겉옷 챙기세요.\n\n입력: 어제 5도, 오늘 8도\n출력: 어제보다 3도 올라 조금 포근해졌습니다. 좋은 하루 되세요.\n\n입력: 어제 18도, 오늘 12도\n출력: 어제보다 6도 내려가 쌀쌀합니다. 따뜻하게 입으세요.\n</good_examples>\n\n<task>\n입력: 어제 25도, 오늘 10도\n출력:",
  "max_new_tokens": 50,
  "temperature": 0.7
}
```

## 간단한 테스트 스크립트

```python
import requests
import json

# 서버 URL
url = "http://localhost:8000/generate"

# 테스트 케이스
test_cases = [
    {"yesterday": 10, "today": 5, "expected": "5도 하강"},
    {"yesterday": 5, "today": 15, "expected": "10도 상승"},
    {"yesterday": 25, "today": 10, "expected": "15도 하강"},
    {"yesterday": 20, "today": 30, "expected": "10도 상승"},
    {"yesterday": 15, "today": 16, "expected": "거의 비슷"},
]

for i, case in enumerate(test_cases, 1):
    prompt = f"""<instruction>
당신은 공원 전광판 메시지 전문가입니다. 주어진 온도 데이터를 간결한 한 문장으로 변환하세요.
</instruction>

<rules>
1. 반드시 한 문장만 출력하세요
2. 마크다운(**, ---, #), 특수문자, 이모지 사용 금지
3. 괄호나 설명 추가 금지
4. 질문 형식 금지
5. "출력:", "답:", "메시지:" 같은 레이블 없이 메시지만 작성
6. 40-70자 길이로 작성
7. 온도 차이를 구체적 숫자로 명시 (예: "5도", "10도")
</rules>

<good_examples>
입력: 어제 20도, 오늘 30도
출력: 어제보다 10도 올라 무더워졌습니다. 수분을 충분히 섭취하세요.

입력: 어제 10도, 오늘 -10도
출력: 어제보다 20도 급격히 내려갔습니다. 방한 준비 철저히 하세요.

입력: 어제 15도, 오늘 16도
출력: 어제와 비슷한 날씨입니다. 산책하기 좋은 하루예요.

입력: 어제 25도, 오늘 15도
출력: 어제보다 10도 낮아졌습니다. 외출 시 겉옷 챙기세요.
</good_examples>

<task>
입력: 어제 {case['yesterday']}도, 오늘 {case['today']}도
출력:"""

    response = requests.post(url, json={
        "prompt": prompt,
        "max_new_tokens": 50,
        "temperature": 0.7
    })

    result = response.json()
    print(f"\n테스트 {i} (어제: {case['yesterday']}도 → 오늘: {case['today']}도)")
    print(f"예상: {case['expected']}")
    print(f"결과: {result['generated_text']}")
    print(f"길이: {len(result['generated_text'])}자")
    print("-" * 80)
```

## 사용 방법

1. **서버 재시작** (변경사항 적용)
   ```bash
   python model_server.py
   ```

2. **curl로 테스트**
   ```bash
   curl -X POST "http://localhost:8000/generate" \
     -H "Content-Type: application/json" \
     -d @- << 'EOF'
   {
     "prompt": "<instruction>\n당신은 공원 전광판 메시지 전문가입니다. 주어진 온도 데이터를 간결한 한 문장으로 변환하세요.\n</instruction>\n\n<rules>\n1. 반드시 한 문장만 출력하세요\n2. 마크다운(**, ---, #), 특수문자, 이모지 사용 금지\n3. 괄호나 설명 추가 금지\n4. 질문 형식 금지\n5. \"출력:\", \"답:\", \"메시지:\" 같은 레이블 없이 메시지만 작성\n6. 40-70자 길이로 작성\n7. 온도 차이를 구체적 숫자로 명시\n</rules>\n\n<good_examples>\n입력: 어제 20도, 오늘 30도\n출력: 어제보다 10도 올라 무더워졌습니다. 수분을 충분히 섭취하세요.\n\n입력: 어제 10도, 오늘 -10도\n출력: 어제보다 20도 급격히 내려갔습니다. 방한 준비 철저히 하세요.\n</good_examples>\n\n<task>\n입력: 어제 10도, 오늘 5도\n출력:",
     "max_new_tokens": 50,
     "temperature": 0.7
   }
   EOF
   ```

3. **Python 스크립트로 테스트** (위의 스크립트 사용)
